---
title: "Fibrinolysis_Regression"
output:
  pdf_document:
    toc: true
    toc_depth: 2
author: "Kamal Mandava"
---

```{r}
library(car)
library(MASS)
library(leaps)
library(psych)
library(corrplot)
```

# Introduction

## Motivation

Fibrinolysis is a process that involves the breakdown of blood clots, which is essential for maintaining proper blood flow. Understanding the relationship between various biochemical parameters and the rate of fibrinolysis has significant implications for both clinical medicine and pharmaceutical research. By modeling how different kinetic constants and binding affinities influence the median lysis time, we can gain insights into the underlying mechanisms of clot dissolution and potentially identify key factors that could be targeted for therapeutic interventions.

## Research Questions

This analysis seeks to answer several important questions:

1. Which biochemical parameters (kinetic constants and binding affinities) are most predictive of median lysis time?
2. Can we develop a reliable statistical model to predict fibrinolysis rates based on these chemical affinity variables?
3. How do transformations of the variables affect the model's predictive power and interpretability?
4. What is the relative importance of different parameters in determining fibrinolysis outcomes?

## Dataset Description

The dataset contains measurements from 42 experimental observations, each with 9 independent variables representing various kinetic constants and binding affinities related to the fibrinolysis process. These include parameters such as the rate constant for tissue plasminogen activator (tPA) binding, plasminogen activation rates, dissociation constants for various protein complexes, and the snap proportion. The dependent variable of interest is the median lysis time, which represents the time taken for clot dissolution under specific experimental conditions.


# Results
### ReadCSV
```{r}
lysis <- read.csv("target.csv")
```
### Summary Statistics
```{r}
summary(lysis)

sapply(lysis, sd)

describe(lysis)

pairs(lysis[, c("medianlysis", "Snap.Proportion", "ktPAon", "kplioff", "kplgon", "KdtPAyesplg", "KdtPAnoplg", "KdPLGnicked", "KdPLGintact", "kdeg.and.kncat")], lower.panel=NULL)
```

**Figure 1: Pairwise scatterplots of all variables.** This plot matrix provides a visual overview of the relationships between variables, helping to identify potential linear association before formal modeling. Visually we can see that there is no linear relationship present between median lysis and other variables which means that we might need to transform the variables necessarily.


### Fitting the Original Model

```{r}

Org_model <- lm(medianlysis ~., data = lysis)
summary(Org_model)

```
Global $F$-test:

$H_0: \beta_1 = \beta_2 = ..... = 0$

$H_1: \text{ALOI}$

$F = 0.222$

$p = 0.989 > 0.05$

Fail to Reject $H_0$, insufficient evidence to conclude the model is useful

This model is statistically insignificant



### Correlation
```{r}
cor(lysis)


corrplot(cor(lysis), method = "color", t1.cex=0.7)
```

**Figure 2: Correlation matrix visualization.** The color coded correlation plot reveals the strength and direction of linear relationships between variables. Strong correlations (close to ±1) appear in darker colors, while weak correlations appear lighter. This helps identify potential multicollinearity issues that could affect regression modeling, which in this case there is no correlation relationship among the independent variables.


### Diagnostics

```{r}
par(mfrow=c(3,3))
for(i in 1:9) hist(lysis[[i]], main=names(lysis)[i])
hist(lysis$medianlysis, main="medianlysis")

```

**Figure 3: Distribution histograms for all variables.** These histograms reveal the distributional properties of each variable, including skewness, potential outliers, and whether transformations might be necessary to meet normality assumptions for regression analysis.
Log transformation is used to address right skewness and improve linearity, Log transformation compresses large values more than small ones, reducing the impact of extreme values and making the distribution more symmetric.




### Actions to tackle skewness and make the normality assumpltion valid

```{r}
# Snap.Proportion is a proportion (0–1), not a rate constant or concentration. It may already be bounded and less skewed, or have a different distribution, so log transformation is unecessary.




lysis$ktPAon_log <- log(lysis$ktPAon)
lysis$kplioff_log <- log(lysis$kplioff)
lysis$kplgon_log <- log(lysis$kplgon)
lysis$KdtPAyesplg_log <- log(lysis$KdtPAyesplg)
lysis$KdtPAnoplg_log <- log(lysis$KdtPAnoplg)
lysis$KdPLGnicked_log <- log(lysis$KdPLGnicked)
lysis$KdPLGintact_log <- log(lysis$KdPLGintact)
lysis$kdeg_kncat_log <- log(lysis$kdeg.and.kncat)

# Keep transformed predictors + original Snap.Proportion
lysis_trans <- data.frame(
  Snap.Proportion = lysis$Snap.Proportion,
  ktPAon_log = lysis$ktPAon_log,
  kplioff_log = lysis$kplioff_log,
  kplgon_log = lysis$kplgon_log,
  KdtPAyesplg_log = lysis$KdtPAyesplg_log,
  KdtPAnoplg_log = lysis$KdtPAnoplg_log,
  KdPLGnicked_log = lysis$KdPLGnicked_log,
  KdPLGintact_log = lysis$KdPLGintact_log,
  kdeg_kncat_log = lysis$kdeg_kncat_log,
  medianlysis = lysis$medianlysis
)

# Quick check
summary(lysis_trans)

par(mfrow=c(3,3))
for(i in 1:9) hist(lysis_trans[[i]], main=names(lysis_trans)[i])

```
So based on this transformation i can interpret that:

There are concentrated bars after transformation, this is mainly due to the fact that:
1) Limited distinct values in the original data.
2) Small sample size (n = 42)

I don't necessarily consider it to be a problem. For regression You don’t need perfectly normal distributions for predictors. The thing that matters the most is the relationships are more linear and variance is more stable.
The concentration in the center is often better than the original extreme right skew.

Hence the log transformation successfully addressed the extreme right skewness observed in most of the kinetic parameters.

### Model Fitting after Log Transformation
```{r}
#Model Fitting

lysis_lm <- lm(medianlysis ~., data = lysis_trans)

summary(lysis_lm)

```

The initial model with all predictors and the untransformed response variable performed poorly. The global F-test p-value of 0.989 indicates that the model as a whole is not statistically significant at any conventional level ($\alpha$ = 0.05). This means we cannot reject the null hypothesis that all regression coefficients are zero. These results clearly indicate that transformations or alternative modeling approaches are necessary.

After the Logrithmic Transformation of independent variables:

Global $F$-test:

$H_0: \beta_1 = \beta_2 = ......= 0$

$H_1: \text{ALOI}$

$F = 3.744$

$p = 0.002637 < 0.05$

Reject $H_0$, sufficient evidence to conclude the model is useful

The Transformed regression model performed well and is statistically significant. with an Adjusted R squared of 0.3759 which means that the regression model explains 37.59% of variance in median lysis which is far better than our original model, but i consider to improve the adjusted R squared since only ~37% of variance is being explained



### boxcox transformation
```{r}
boxcox(lysis_lm)
```

The Box-Cox transformation analysis suggests an optimal lambda value close to -1, which corresponds to the reciprocal transformation (1/Y). This indicates that the response variable (median lysis) also requires transformation to better meet the assumptions of linear regression.


### Reciprocal Transformation of Y
```{r}
lysis_trans$medianlysis <- 1/(lysis_trans$medianlysis) # this would push the inverse of medianlysis to medianlysis variable - the name remains unchanged but the transformation happens

# refitting the model with transformed data

trans_lysis_lm <- lm(medianlysis ~., data = lysis_trans)

summary(trans_lysis_lm)


```

After applying the reciprocal transformation to the dependent variable, the model performance improved substantially. This suggests that the model with all predictors does have some predictive power. The adjusted R-squared increased to 0.8375, meaning the model now explains approximately 83.75% of the variance in the transformed median lysis time. While this is a significant improvement from the initial original model, i would like to take a step further and perform analysis on which predictors best explain the variance in median lysis. Also the model still indicates that a substantial portion of the variability remains unexplained. This is mainly due to the experimental data that has been obtained. The experimental data had observations that have been scaled 10x times for each experiments which might have been marked as potential outliers.

### Further Analysis 
### 1) VIF
```{r}
# Checking for multi-collinearity
vif(trans_lysis_lm) # No multi-collinearity present all are less than 10 (cut-off)

```

The variance inflation factors (VIFs) for all predictors are below the commonly used threshold of 10, indicating that multi-collinearity is not a serious concern in this model. This is an important finding because high multi-collinearity can make coefficient estimates unstable and difficult to interpret. The fact that all VIFs are reasonable suggests that each predictor provides somewhat unique information about the response variable.


### 2) Variable screening
```{r}
fwd <- lm(medianlysis ~ 1, data = lysis_trans)
out_fwd <- step(fwd, scope = ~ Snap.Proportion + ktPAon_log + kplioff_log + kplgon_log + KdtPAyesplg_log + KdtPAnoplg_log +KdPLGnicked_log+ KdPLGintact_log+kdeg_kncat_log , direction = "forward")

summary(out_fwd)

```

The forward stepwise selection procedure identified a more parsimonious model by systematically adding variables that improve model fit. 

The AIC decreased from -42.69 (for the null model with only an intercept) to -50.18 for the final selected model. Since lower AIC values indicate better model fit while penalizing for model complexity, this substantial drop confirms that the selected predictors significantly improve the model beyond what we'd expect from chance alone. The final model from forward selection shows little increase in Adjusted R squared when compared to full model, indicating stronger statistical significance. suggesting that while we've identified the most important predictors, there may be inherent limitations in how well these variables can predict fibrinolysis rates.


### 3)  All-Possible-Regressions Selection Procedure

```{r}
subset_model <- regsubsets(medianlysis ~ kdeg_kncat_log + kplioff_log + 
                           Snap.Proportion + ktPAon_log + KdtPAnoplg_log +
                           KdtPAyesplg_log + kplgon_log + KdPLGnicked_log + 
                           KdPLGintact_log,
                           data = lysis_trans)

summary(subset_model)$outmat


names(summary(subset_model))


which.min(summary(subset_model)$bic) # gives 1 variable model; which means 1 variable model is best according to bic

which.max(summary(subset_model)$adjr2) # gives 5 variable model; which means 5 variable model is best accroding to Adjusted R squared


plot(subset_model, scale = "adjr2")
```

**Figure 4: All-possible regressions comparison plot.** This visualization shows how adjusted R-squared changes as we add more variables to the model.

My Main goal is to have a good prediction model, so i am considering adjusted-R-squared over BIC which is a 6 variable model.


### Modelling Best Possible Regression Model
```{r}
best_model <- lm(medianlysis ~ kdeg_kncat_log + kplioff_log +Snap.Proportion + ktPAon_log + KdtPAnoplg_log + kplgon_log, data = lysis_trans)

summary(best_model)

```

## Global F-Test and Model Summary

The final best model includes six predictors: `kdeg_kncat_log`, `kplioff_log`, `Snap.Proportion`, `ktPAon_log`, `KdtPAnoplg_log`, and `kplgon_log`. 
Global $F$-test

$H_0: \beta_1 = \beta_2 = \dots = \beta_9 = 0$

$H_1: \text{ALOI}$

$F = 39.74$

$p < 0.05 $

Reject $H_0$, sufficient evidence to conclude the model is useful

## Regression Equation

Based on the final model, the regression equation can be written as:

**1/medianlysis = 3.48761 + 0.34842 * (kdeg_kncat_log) + 0.11895 * (kplioff_log) - 2.47596 (Snap.Proportion) + 0.34749 * (ktPAon_log) + 0.41269 * (KdtPAnoplg_log) - 0.06423 * (kplgon_log)**

Each coefficient ($\beta_i$) represents the expected change in the reciprocal of median lysis time for a one-unit increase in the corresponding predictor, holding all other predictors constant. Since we're working with log-transformed predictors, the interpretation involves percentage changes rather than absolute changes, which is more appropriate for rate constants and binding affinities.

## Interpretation of Individual Coefficients

The individual coefficient estimates and their significance tests tell us which predictors have statistically significant relationships with the response variable. A significant coefficient (typically p < 0.05) suggests that the corresponding variable has a meaningful association with median lysis time after accounting for all other variables in the model. The sign of the coefficient indicates the direction of the relationship - positive coefficients suggest that increases in the predictor are associated with increases in the response (or decreases in median lysis time, since we're modeling the reciprocal), while negative coefficients suggest the opposite relationship.

The Best Adjusted R Squared that i can get is from a 6 predictors model



##Residual Analysis
```{r}
# Constant variance check
plot(best_model, 1)

# Normality check
plot(best_model, 2)

#Outlier check
rstd <- rstandard(best_model)
which(abs(rstd)>3)


# High Leverage
h <- hatvalues(best_model)
# cut-off value would be: (2(k+1))/n = (2*(5+1))/42 = 12/42 = 0.2857143
which(h > 0.2857143)

# influential Observations
ckd <- cooks.distance(best_model)
which(ckd > 0.5)
which(ckd > 1)


plot(best_model, 5)
```

**Figure 5: Residual diagnostic plots.** These plots assess whether the model assumptions are met and identify potential problematic observations.

## Residual Analysis Summary

**Constant Variance:** The residuals vs fitted plot shows a wavy pattern and non-constant spread (wider at extremes, narrower in the middle), indicating mild heteroscedasticity.

**Normality:** The Q-Q plot shows an S-shape with deviations in both tails (observations 13, 33 in lower tail; 7 in upper tail), suggesting heavier tails than normal.

**Outliers:** Observation 13 has a standardized residual < -3.

**High Leverage:** Nine observations (5, 14, 17, 22, 25, 34, 37, 38, 42) have high leverage.

**Influence:** No observations exceed Cook's distance thresholds of 0.5 or 1.0, though observations 34 and 250 are near the 0.5 contour and may have some influence.






# Discussion

## Main Findings and Concluding Remarks

This analysis successfully developed a predictive model for fibrinolysis rates, achieving an adjusted R-squared of 0.8501 (85.01%) with six predictors. This represents a dramatic improvement from the original model, which had a negative adjusted R-squared (-0.2059) and was statistically insignificant (p = 0.989). The transformation approach proved essential: log transformations of the kinetic parameters addressed extreme right skewness, while the reciprocal transformation of the response variable (suggested by Box-Cox analysis) was crucial for achieving both statistical significance and high explanatory power.

The final model identifies five highly significant predictors: the degradation and catalytic rate constant (kdeg_kncat_log), plasminogen dissociation rate (kplioff_log), snap proportion (negative relationship), tPA binding rate (ktPAon_log), and dissociation constant for tPA without plasminogen (KdtPAnoplg_log). Interestingly, removing three variables from the full model (KdtPAyesplg_log, KdPLGnicked_log, KdPLGintact_log) actually improved the adjusted R-squared from 0.8375 to 0.8501, indicating these variables added noise rather than meaningful information. The sixth variable (kplgon_log) is included in the model but is not statistically significant (p = 0.259), suggesting it may have limited predictive value.

The most important finding is that fibrinolysis rates depend on multiple kinetic constants and binding affinities working together, rather than any single parameter. These variables represent different aspects of the complex biochemical network involved in clot dissolution. From a practical standpoint, this model could be useful for predicting fibrinolysis outcomes in experimental settings, with the 85% variance explained providing strong predictive capability.

## Limitations of the Analysis

I should acknowledge several limitations.

First, the sample size of 42 observations is relatively small for a model with 6 predictors. While sufficient for this analysis, a larger sample would provide more stable coefficient estimates and greater statistical significance.

Second, despite explaining 85% of the variance, 15% remains unexplained. I am actually satisfied with the 85% of variance getting explained especially for a complex biological data like this. But the rest of the 15% remains unexplained which might be a bit might be achieved by adding more observations into the data set.

Third, residual analysis revealed violations of some regression assumptions. The residuals vs fitted plot shows mild heteroscedasticity (non-constant variance), and the Q-Q plot shows an S-shape with heavier tails than normal. While these violations don't necessarily invalidate the model, they suggest that standard errors and p-values should be interpreted with some caution. The presence of one outlier (observation 13) and nine high leverage points also suggests some unusual cases in the data, though no observations exceed Cook's distance thresholds, indicating no highly influential points.

Fourth, model selection involved multiple steps (forward selection, all-possible regressions), and different criteria suggested different optimal models. BIC favored a 5-variable model, while adjusted R-squared favored a 6-variable model. The choice to prioritize adjusted R-squared for prediction purposes highlights the subjective nature of model selection.

Finally, this analysis is correlational and observational. We cannot establish causal relationships, and the associations could be confounded by unmeasured variables or reflect correlations rather than direct causal effects.

## What Would Be Done Differently

If redoing this project, several improvements could be made:

First, I would collect a larger sample size (ideally 100-150 observations) to provide more statistical power and allow for proper train-test validation (Cross Validation), which would give a more realistic assessment of predictive performance on unseen data.

Second, I might also explore robust regression methods that are less sensitive to outliers.

Third, I would consider alternative modeling approaches. Given the mild heteroscedasticity, weighted least squares regression might be appropriate. If nonlinear relationships are suspected, polynomial terms or interaction effects could be explored. Machine learning approaches like random forests could provide complementary insights, though with reduced interpretability.


Fourth, I would explore collecting additional variables that might be relevant to fibrinolysis but weren't included in the original dataset.

Finally, I would conduct a more thorough sensitivity analysis to understand how robust the conclusions are to different modeling choices, transformations, and handling of outliers.

## Future Research Directions

Several research directions emerged from this analysis. First, expanding the dataset to include more observations and potentially more variables would allow for more sophisticated modeling and more reliable conclusions. This could include additional kinetic parameters, environmental factors (like temperature, pH, or ion concentrations), or characteristics of the clot itself.

Second, investigating nonlinear relationships and potential interactions between variables could reveal more complex patterns. For instance, the effect of one kinetic constant might depend on the value of another, suggesting that interaction terms could improve the model. Polynomial terms or spline functions could capture curvilinear relationships that the linear model misses.

Third, exploring the biological mechanisms underlying the statistical associations could provide deeper insights. Understanding why certain parameters are predictive could lead to testable hypotheses about the fibrinolysis process and potentially identify new therapeutic targets.

Fourth, developing more sophisticated models that account for the heteroscedasticity and other assumption violations could improve both prediction accuracy and the reliability of statistical inferences. This might involve generalized least squares, robust regression methods, or Bayesian approaches.


Finally, translating these statistical findings into practical applications could involve developing predictive tools for clinical or pharmaceutical research. If the model can reliably predict fibrinolysis rates, it could be used to screen potential therapeutic compounds or optimize experimental conditions without requiring extensive laboratory work.

In conclusion, while this analysis has limitations, it provides a solid foundation for understanding the relationships between biochemical parameters and fibrinolysis rates. The transformation approach and model selection process successfully improved the model from statistically insignificant to explaining 85% of the variance. The identified predictors represent a starting point for further investigation, and the methodological approaches developed here could be refined and extended in future work.

